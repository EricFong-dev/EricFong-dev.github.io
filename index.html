<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KLOOK å¤§ç£å€ç›²ç›’é«”é©—</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f0f8ff;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .selectors {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 30px;
            max-width: 800px;
            width: 100%;
            margin: 30px 0;
        }

        .selector-group {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .selector-card {
            padding: 15px;
            margin: 10px 0;
            border: 2px solid #eee;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .city-card.selected {
            border-color: #4CAF50;
            background: #E8F5E9;
        }

        .theme-card.selected {
            border-color: #2196F3;
            background: #E3F2FD;
        }

        /* æ‰­è›‹æ©Ÿå‹•ç•«æ¨£å¼ */
        .gacha-machine {
            position: relative;
            width: 300px;
            height: 400px;
            margin: 30px 0;
            display: none;
            z-index: 100;
        }

        .machine-body {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 80%;
            background: #FF5722;
            border-radius: 15px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        .egg {
            position: absolute;
            width: 80px;
            height: 100px;
            left: 50%;
            top: 30%;
            transform: translateX(-50%);
            opacity: 0;
            z-index: 2;
            transition: all 0.5s;
        }

        @keyframes machineShake {
            0% { transform: rotate(0deg); }
            25% { transform: rotate(8deg); }
            50% { transform: rotate(-8deg); }
            75% { transform: rotate(4deg); }
            100% { transform: rotate(0deg); }
        }

        @keyframes eggDrop {
            0% { top: 30%; opacity: 0; }
            30% { top: 50%; opacity: 1; }
            100% { top: 70%; opacity: 1; }
        }

        @keyframes eggOpen {
            0% { transform: scale(1); }
            50% { transform: scale(1.2) rotate(15deg); }
            100% { transform: scale(0) rotate(30deg); }
        }

        #generate-btn, .buy-button {
            padding: 15px 40px;
            background: #FF6B6B;
            color: white;
            border: none;
            border-radius: 30px;
            font-size: 18px;
            cursor: pointer;
            transition: transform 0.3s;
            margin: 10px;
        }

        .buy-button {
            background: #4CAF50;
        }

        .itinerary-box {
            width: 100%;
            max-width: 800px;
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin: 30px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            display: none;
        }

        .activity-item {
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #4CAF50;
            background: #f8f9fa;
        }

        .highspeed-rail {
            color: #2196F3;
            font-weight: bold;
            padding: 15px;
            background: #e3f2fd;
            border-radius: 8px;
            margin: 15px 0;
        }

        .total-price {
            font-size: 24px;
            color: #FF6B6B;
            text-align: right;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <h1>é€±æœ«å¤§ç£å€ç›²ç›’é«”é©—</h1>

    <div class="selectors">
        <div class="selector-group">
            <h3>é¸æ“‡ç›®çš„åœ°</h3>
            <div class="city-card selector-card" data-city="shenzhen">æ·±åœ³</div>
            <div class="city-card selector-card" data-city="guangzhou">å»£å·</div>
            <div class="city-card selector-card" data-city="zhuhai">ç æµ·</div>
        </div>

        <div class="selector-group">
            <h3>é¸æ“‡ä¸»é¡Œ</h3>
            <div class="theme-card selector-card" data-theme="food">ç¾é£Ÿä¹‹æ—…</div>
            <div class="theme-card selector-card" data-theme="shopping">è³¼ç‰©ç‹‚æ­¡</div>
            <div class="theme-card selector-card" data-theme="culture">æ–‡åŒ–æ¢ç´¢</div>
        </div>
    </div>

    <button id="generate-btn">æŠ½ç›²ç›’ï¼</button>
    
    <div class="gacha-machine">
        <div class="machine-body"></div>
        <div class="egg">
            <img src="https://example.com/egg.png" alt="æ‰­è›‹" style="width:100%">
        </div>
    </div>

    <div class="itinerary-box" id="result"></div>

    <audio id="shake-sound">
        <source src="shake.mp3" type="audio/mpeg">
    </audio>
    <audio id="drop-sound">
        <source src="drop.mp3" type="audio/mpeg">
    </audio>
    <audio id="open-sound">
        <source src="open.mp3" type="audio/mpeg">
    </audio>

    <script>
        // éŸ³æ•ˆæ§åˆ¶
        const sounds = {
            shake: document.getElementById('shake-sound'),
            drop: document.getElementById('drop-sound'),
            open: document.getElementById('open-sound')
        };

        // å®Œæ•´è¡Œç¨‹æ•¸æ“šï¼ˆæ¯å€‹çµ„åˆ3å€‹æ–¹æ¡ˆï¼‰
        const demoData = {
            shenzhen: {
                food: [
                    {
                        activities: [
                            { time: "09:00", name: "è€å­—å·æ—©èŒ¶ä½“éªŒ", price: 120 },
                            { time: "12:30", name: "æµ·é²œå¸‚åœºç¾é£Ÿæ¸¸", price: 250 },
                            { time: "15:00", name: "åˆ›æ„èŒ¶é¥®å·¥ä½œåŠ", price: 80 }
                        ]
                    },
                    {
                        activities: [
                            { time: "10:00", name: "ç½‘çº¢ç«é”…åº—å¥—é¤", price: 180 },
                            { time: "13:00", name: "å¤œå¸‚å°åƒå·¡ç¤¼", price: 150 },
                            { time: "16:30", name: "ç”œå“åˆ¶ä½œä½“éªŒ", price: 90 }
                        ]
                    },
                    {
                        activities: [
                            { time: "08:30", name: "ä¼ ç»Ÿçƒ§è…Šä½“éªŒ", price: 200 },
                            { time: "11:30", name: "ä¸»é¢˜é¤å…åˆé¤", price: 180 },
                            { time: "15:30", name: "å’–å•¡æ‹‰èŠ±è¯¾ç¨‹", price: 100 }
                        ]
                    }
                ],
                shopping: [
                    {
                        activities: [
                            { time: "10:00", name: "ä¸‡è±¡åŸè´­ç‰©ç¤¼åŒ…", price: 500 },
                            { time: "13:30", name: "ç”µå­å¸‚åœºä½“éªŒ", price: 300 },
                            { time: "16:00", name: "å…ç¨åº—ä¼˜æƒ åˆ¸", price: 200 }
                        ]
                    },
                    {
                        activities: [
                            { time: "11:00", name: "å¥¢ä¾ˆå“ä¸“å–ä½“éªŒ", price: 800 },
                            { time: "14:30", name: "è®¾è®¡å¸ˆå“ç‰Œåº—", price: 450 },
                            { time: "17:00", name: "ç¾å¦†å…ç¨å¥—é¤", price: 600 }
                        ]
                    },
                    {
                        activities: [
                            { time: "09:30", name: "æ‰¹å‘å¸‚åœºæ¢ç§˜", price: 150 },
                            { time: "13:00", name: "æ½®æµæœé¥°é‡‡è´­", price: 400 },
                            { time: "16:30", name: "æ•°ç äº§å“ä½“éªŒ", price: 350 }
                        ]
                    }
                ],
                culture: [
                    {
                        activities: [
                            { time: "09:00", name: "å¤åŸæ–‡åŒ–å¯¼è§ˆ", price: 80 },
                            { time: "12:30", name: "éé—å·¥è‰ºä½“éªŒ", price: 120 },
                            { time: "15:30", name: "ç°ä»£è‰ºæœ¯å±•è§ˆ", price: 100 }
                        ]
                    },
                    {
                        activities: [
                            { time: "10:30", name: "å†å²åšç‰©é¦†å‚è§‚", price: 60 },
                            { time: "13:30", name: "ä¼ ç»Ÿæ‰‹ä½œä½“éªŒ", price: 150 },
                            { time: "16:00", name: "å‰§åœºè¡¨æ¼”é—¨ç¥¨", price: 200 }
                        ]
                    },
                    {
                        activities: [
                            { time: "08:30", name: "å¯ºåº™æ–‡åŒ–ä½“éªŒ", price: 0 },
                            { time: "11:00", name: "å¤å»ºç­‘æ‘„å½±æ¸¸", price: 80 },
                            { time: "15:00", name: "æ–‡åˆ›å›­åŒºå¯¼è§ˆ", price: 90 }
                        ]
                    }
                ]
            },
            guangzhou: {
                culture: [
                    {
                        activities: [
                            { time: "09:00", name: "é™ˆå®¶ç¥ æ·±åº¦æ¸¸", price: 80 },
                            { time: "12:30", name: "ç²¤å‰§æ–‡åŒ–ä½“éªŒ", price: 120 },
                            { time: "15:30", name: "è€åŸåŒºå†å²æ¼«æ­¥", price: 0 }
                        ]
                    },
                    {
                        activities: [
                            { time: "10:00", name: "åšç‰©é¦†å¯¼è§ˆ", price: 60 },
                            { time: "13:00", name: "ä¼ ç»Ÿæ—©èŒ¶æ–‡åŒ–", price: 100 },
                            { time: "16:00", name: "å¤æ¸¯é—å€å‚è§‚", price: 50 }
                        ]
                    },
                    {
                        activities: [
                            { time: "08:30", name: "å²­å—å»ºç­‘æ¢ç´¢", price: 70 },
                            { time: "11:30", name: "éé—å‰ªçº¸è¯¾ç¨‹", price: 90 },
                            { time: "15:00", name: "èŒ¶æ–‡åŒ–ä½“éªŒ", price: 80 }
                        ]
                    }
                ],
                food: [
                    {
                        activities: [
                            { time: "09:30", name: "å¹¿å·é…’å®¶æ—©èŒ¶å¥—é¤", price: 180 },
                            { time: "12:00", name: "é™ˆæ·»è®°é±¼çš®ä½“éªŒ", price: 50 },
                            { time: "15:00", name: "æ²™æ¹¾å§œæ’å¥¶å·¥ä½œåŠ", price: 80 }
                        ]
                    },
                    {
                        activities: [
                            { time: "10:00", name: "æ³®æºªé…’å®¶ç‚¹å¿ƒå®´", price: 220 },
                            { time: "13:00", name: "å®åè·¯å°åƒå·¡ç¤¼", price: 100 },
                            { time: "16:00", name: "é¡ºå¾·åŒçš®å¥¶ä½“éªŒ", price: 60 }
                        ]
                    },
                    {
                        activities: [
                            { time: "08:00", name: "ä¼ ç»Ÿç²¥å“æ—©é¤", price: 40 },
                            { time: "11:30", name: "çƒ§è…Šä¸“é—¨åº—ä½“éªŒ", price: 120 },
                            { time: "15:30", name: "ç³–æ°´åˆ¶ä½œè¯¾ç¨‹", price: 70 }
                        ]
                    }
                ],
                shopping: [
                    {
                        activities: [
                            { time: "10:00", name: "å¤©æ²³åŸè´­ç‰©å¥—ç¥¨", price: 400 },
                            { time: "13:30", name: "åŒ—äº¬è·¯æ­¥è¡Œè¡—ç¤¼åŒ…", price: 300 },
                            { time: "16:00", name: "ä¸Šä¸‹ä¹æ‰‹ä¿¡ä¼˜æƒ åˆ¸", price: 200 }
                        ]
                    },
                    {
                        activities: [
                            { time: "11:00", name: "å¤ªå¤æ±‡å¥¢ä¾ˆå“ä½“éªŒ", price: 600 },
                            { time: "14:30", name: "ä¸‡è±æ‰¹å‘å¸‚åœºæ¢ç§˜", price: 150 },
                            { time: "17:00", name: "ç æ±Ÿæ–°åŸè´­ç‰©åˆ¸", price: 350 }
                        ]
                    },
                    {
                        activities: [
                            { time: "09:30", name: "æ²™æ²³æœè£…æ‰¹å‘", price: 250 },
                            { time: "13:00", name: "ä¸€å¾·è·¯å¹²è´§å¸‚åœº", price: 180 },
                            { time: "16:30", name: "ç¾å¦†é›†åˆåº—ä½“éªŒ", price: 300 }
                        ]
                    }
                ]
            },
            zhuhai: {
                shopping: [
                    {
                        activities: [
                            { time: "10:00", name: "å…ç¨åŸè´­ç‰©åˆ¸", price: 600 },
                            { time: "13:30", name: "ç å®æ‰¹å‘å¸‚åœº", price: 800 },
                            { time: "16:00", name: "è®¾è®¡å¸ˆé›†åˆåº—", price: 400 }
                        ]
                    },
                    {
                        activities: [
                            { time: "11:00", name: "æµ·å‘³å¹²è´§é‡‡è´­", price: 300 },
                            { time: "14:00", name: "è·¨å¢ƒå•†å“ä½“éªŒ", price: 500 },
                            { time: "17:00", name: "å¥¢ä¾ˆå“æŠ˜æ‰£åº—", price: 700 }
                        ]
                    },
                    {
                        activities: [
                            { time: "09:30", name: "å¥¥ç‰¹è±æ–¯ä¼˜æƒ åˆ¸", price: 450 },
                            { time: "13:00", name: "æœ¬åœ°ç‰¹äº§é‡‡è´­", price: 200 },
                            { time: "16:30", name: "ç”µå­äº§å“ä½“éªŒ", price: 350 }
                        ]
                    }
                ],
                food: [
                    {
                        activities: [
                            { time: "10:00", name: "æ¨ªç´èšç¾é£Ÿä½“éªŒ", price: 200 },
                            { time: "12:30", name: "æ–—é—¨é‡å£³èŸ¹å¥—é¤", price: 350 },
                            { time: "15:00", name: "ç æµ·æ¸”å¥³èŒ¶ç‚¹å¥—é¤", price: 120 }
                        ]
                    },
                    {
                        activities: [
                            { time: "11:00", name: "æ¹¾ä»”æµ·é²œè¡—ä½“éªŒ", price: 280 },
                            { time: "13:30", name: "é‡‘æ‚¦è½©æ—©èŒ¶å¥—é¤", price: 180 },
                            { time: "16:00", name: "æ¾³é—¨è‘¡æŒå·¥ä½œåŠ", price: 90 }
                        ]
                    },
                    {
                        activities: [
                            { time: "09:00", name: "ä¼ ç»ŸèŒ¶æœåˆ¶ä½œ", price: 60 },
                            { time: "12:00", name: "æµ·é²œç«é”…ä½“éªŒ", price: 320 },
                            { time: "15:30", name: "è‘¡å¼æ–™ç†è¯¾ç¨‹", price: 150 }
                        ]
                    }
                ],
                culture: [
                    {
                        activities: [
                            { time: "09:00", name: "åœ†æ˜æ–°å›­å¯¼è§ˆå¥—ç¥¨", price: 100 },
                            { time: "12:30", name: "å”å®¶æ¹¾å¤é•‡å‚è§‚", price: 0 },
                            { time: "15:00", name: "ç æµ·åšç‰©é¦†é—¨ç¥¨", price: 50 }
                        ]
                    },
                    {
                        activities: [
                            { time: "10:00", name: "åŒ—å±±æ‘æ–‡åˆ›ä½“éªŒ", price: 80 },
                            { time: "13:00", name: "æ·‡æ¾³å²›çº¢æ ‘æ—å¯¼è§ˆ", price: 60 },
                            { time: "15:30", name: "å®¹é—³çºªå¿µé¦†å‚è§‚", price: 30 }
                        ]
                    },
                    {
                        activities: [
                            { time: "08:30", name: "æ–—é—¨å¤è¡—æ¸¸è§ˆ", price: 0 },
                            { time: "11:30", name: "æ°´ä¸Šå©šå«è¡¨æ¼”", price: 90 },
                            { time: "15:00", name: "æµ·æ´‹æ–‡åŒ–å±•è§ˆ", price: 70 }
                        ]
                    }
                ]
            }
        };

        let selectedCity = null;
        let selectedTheme = null;
        let isAnimating = false;

        // ç¶å®šé¸æ“‡äº‹ä»¶
        document.querySelectorAll('.city-card').forEach(card => {
            card.addEventListener('click', function() {
                if(isAnimating) return;
                document.querySelectorAll('.city-card').forEach(c => c.classList.remove('selected'));
                this.classList.add('selected');
                selectedCity = this.dataset.city;
            });
        });

        document.querySelectorAll('.theme-card').forEach(card => {
            card.addEventListener('click', function() {
                if(isAnimating) return;
                document.querySelectorAll('.theme-card').forEach(c => c.classList.remove('selected'));
                this.classList.add('selected');
                selectedTheme = this.dataset.theme;
            });
        });

        // å‹•ç•«æ§åˆ¶
        async function playGachaAnimation() {
            return new Promise(resolve => {
                const machine = document.querySelector('.gacha-machine');
                const egg = document.querySelector('.egg');

                // é‡ç½®ç‹€æ…‹
                machine.style.display = 'block';
                egg.style.opacity = '0';
                egg.style.top = '30%';
                egg.style.animation = 'none';
                machine.style.animation = 'none';
                void machine.offsetHeight; // å¼·åˆ¶é‡ç¹ª

                // å•Ÿå‹•å‹•ç•«
                machine.style.animation = 'machineShake 1s ease-in-out';
                egg.style.animation = 'eggDrop 1s ease-out forwards';

                // æ’­æ”¾éŸ³æ•ˆ
                sounds.shake.play();
                setTimeout(() => sounds.drop.play(), 300);

                const finishAnimation = () => {
                    sounds.open.play();
                    egg.style.animation = 'eggOpen 0.8s ease-out forwards';
                    setTimeout(() => {
                        machine.style.display = 'none';
                        resolve();
                    }, 800);
                };

                egg.addEventListener('animationend', finishAnimation, {once: true});
            });
        }

        // ç”Ÿæˆè¡Œç¨‹
        document.getElementById('generate-btn').addEventListener('click', async () => {
            if(isAnimating) return;
            if(!selectedCity || !selectedTheme) return alert('è«‹å…ˆé¸æ“‡ç›®çš„åœ°å’Œä¸»é¡Œï¼');

            isAnimating = true;
            const resultDiv = document.getElementById('result');
            
            try {
                resultDiv.style.display = 'none';
                await playGachaAnimation();
                
                const itineraries = demoData[selectedCity][selectedTheme];
                const randomIndex = Math.floor(Math.random() * itineraries.length);
                const selectedItinerary = itineraries[randomIndex];
                const totalPrice = 196 + selectedItinerary.activities.reduce((sum, a) => sum + a.price, 0);

                resultDiv.innerHTML = `
                    <div class="highspeed-rail">
                        ğŸš… å»ç¨‹é«˜éµï¼šè¥¿ä¹é¾ç«™ â†’ ${selectedCity} (08:00 - 08:40)
                        <div class="price">ç¥¨åƒ¹ï¼šHK$ 98</div>
                    </div>
                    ${selectedItinerary.activities.map(a => `
                        <div class="activity-item">
                            <div class="time">${a.time}</div>
                            <div class="name">${a.name}</div>
                            <div class="price">KLOOKå¥—ç¥¨åƒ¹æ ¼ï¼šHK$ ${a.price}</div>
                        </div>
                    `).join('')}
                    <div class="highspeed-rail">
                        ğŸš… è¿”ç¨‹é«˜éµï¼š${selectedCity} â†’ è¥¿ä¹é¾ç«™ (20:30 - 21:10)
                        <div class="price">ç¥¨åƒ¹ï¼šHK$ 98</div>
                    </div>
                    <div class="total-price">
                        ç¸½åƒ¹æ ¼ï¼šHK$ ${totalPrice}
                    </div>
                    <button class="buy-button" onclick="handlePurchase()">ä¸€éµè³¼è²·</button>
                `;
                resultDiv.style.display = 'block';
                
            } catch (error) {
                console.error('æµç¨‹éŒ¯èª¤:', error);
                alert('ç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹åˆ·æ–°é é¢é‡è©¦');
            } finally {
                isAnimating = false;
            }
        });

        // è³¼è²·åŠŸèƒ½
        window.handlePurchase = () => {
            alert('å³å°‡è·³è½‰è‡³æ”¯ä»˜é é¢ï¼\næ­¤ç‚ºæ¼”ç¤ºåŠŸèƒ½ï¼Œå¯¦éš›éœ€æ¥å…¥æ”¯ä»˜æ¥å£');
        }
    </script>
</body>
</html>